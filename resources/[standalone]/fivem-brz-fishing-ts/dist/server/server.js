"use strict";var __defProp=Object.defineProperty;var __getOwnPropDesc=Object.getOwnPropertyDescriptor;var __getOwnPropNames=Object.getOwnPropertyNames;var __hasOwnProp=Object.prototype.hasOwnProperty;var __export=(target,all)=>{for(var name in all)__defProp(target,name,{get:all[name],enumerable:true})};var __copyProps=(to,from,except,desc)=>{if(from&&typeof from==="object"||typeof from==="function"){for(let key of __getOwnPropNames(from))if(!__hasOwnProp.call(to,key)&&key!==except)__defProp(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable})}return to};var __toCommonJS=mod=>__copyProps(__defProp({},"__esModule",{value:true}),mod);var server_exports={};__export(server_exports,{getPlayerAssignedFish:()=>getPlayerAssignedFish,onResourceStart:()=>onResourceStart,processCatchFishEvent:()=>processCatchFishEvent,processRequestStartFishing:()=>processRequestStartFishing,processUseBaitEvent:()=>processUseBaitEvent});module.exports=__toCommonJS(server_exports);var{MAXIMUM_LINE_TENSION,LINE_TENSION_INCREASE_RATE,TENSION_RECOVER_RATE,PULL_DISTANCE_RATE_PER_TICK,ROD_CAST_CHALLENGE_VELOCITY,ROD_CAST_CHALLENGE_INTERVAL,ROD_CAST_CHALLENGE_ACCELERATION,BAIT_HOLD_CHALLENGE_TIME,FISHES}=SETTINGS;var fishingLimits={maximumLineTension:Number(MAXIMUM_LINE_TENSION)||100,lineTensionIncreaseRate:Number(LINE_TENSION_INCREASE_RATE)||5,tensionRecoverRate:Number(TENSION_RECOVER_RATE)||5,pullDistanceRatePerTick:Number(PULL_DISTANCE_RATE_PER_TICK)||10,rodCastChallengeVelocity:Number(ROD_CAST_CHALLENGE_VELOCITY)||1,rodCastChallengeInterval:Number(ROD_CAST_CHALLENGE_INTERVAL)||1,rodCastChallengeAcceleration:Number(ROD_CAST_CHALLENGE_ACCELERATION)||1e-4,baitHoldChallengeTime:Number(BAIT_HOLD_CHALLENGE_TIME)||500};var fishes=FISHES;var LocaleDefaults={fishing_spot_error:{label:"You are not at a fishing spot.",variables:{}},has_bait_error:{label:"You don't have fishing bait.",variables:{}},has_rod_error:{label:"You don't have a fishing rod.",variables:{}},near_spot_error:{label:"You are not near a fishing spot.",variables:{}},in_vehicle_error:{label:"You can't fish inside a vehicle.",variables:{}},already_fishing_error:{label:"You are already fishing.",variables:{}},fishing_state:{label:"You are now fishing...",variables:{}},fish_command_description:{label:"Start fishing if you are near a fishing spot.",variables:{}},fish_command:{label:"fish",variables:{}},pull_too_hard:{label:"The line broke! pull slower next time.",variables:{}},rod_cast_took_too_long:{label:"You took too long to cast the line",variables:{}},fishing_spot_not_found:{label:"Fishing spot not found",variables:{}},fish_ran_away:{label:"The fish ran away!",variables:{}},fish_pull_hint:{label:"Press [E] to pull the fish! be careful not to break the line!",variables:{}},fish_bite_bait:{label:"The fish bit the bait, press [E] to pull it!",variables:{}},fish_pull_too_soon:{label:"You pulled too soon! the fish ran away.",variables:{}},initialise_script:{label:"brz-fishing by brz.gg has started!",variables:{}},initialise_error:{label:"An error occurred while initializing brz-fishing.",variables:{}},no_fish_assigned:{label:"There's no fish assigned for player id %PLAYER_ID%",variables:{PLAYER_ID:"PLAYER_ID"}},catching_success:{label:"You got a %ITEM_LABEL%!",variables:{ITEM_LABEL:"ITEM_LABEL"}},unknown_error:{label:"An error occurred while initializing brz-fishing.",variables:{}},holdkeydown:{label:"HOLD",variables:{}},press_to_cast:{label:"TO CAST",variables:{}},press_to_pull:{label:"TO PULL",variables:{}}};var BrazilianPortuguese={fishing_spot_error:{label:"Você não está em um ponto de pesca.",variables:{}},has_bait_error:{label:"Você não tem uma isca de pesca.",variables:{}},has_rod_error:{label:"Você não tem uma vara de pesca.",variables:{}},near_spot_error:{label:"Você não está perto de um ponto de pesca.",variables:{}},in_vehicle_error:{label:"Você não pode pescar dentro de um veículo.",variables:{}},already_fishing_error:{label:"Você já está pescando.",variables:{}},fishing_state:{label:"Você agora está pescando...",variables:{}},fish_command_description:{label:"Inicia a pescaria caso esteja próximo a um ponto de pesca.",variables:{}},fish_command:{label:"pescar",variables:{}},pull_too_hard:{label:"A linha estourou! puxe mais devagar na próxima vez.",variables:{}},rod_cast_took_too_long:{label:"Você demorou muito para lançar a linha",variables:{}},fishing_spot_not_found:{label:"Local de pesca não encontrado",variables:{}},fish_ran_away:{label:"O peixe escapou!",variables:{}},fish_pull_hint:{label:"Pressione [E] para puxar o peixe! cuidado para não quebrar a linha!",variables:{}},fish_bite_bait:{label:"O peixe mordeu a isca, pressione [E] para puxá-lo!",variables:{}},fish_pull_too_soon:{label:"Você puxou a linha cedo demais! o peixe acabou fugindo",variables:{}},initialise_script:{label:"brz-fishing por brz.gg iniciado!",variables:{}},initialise_error:{label:"Um erro ocorreu ao iniciar a pesca.",variables:{}},no_fish_assigned:{label:"Não há peixe atribuído ao player id %PLAYER_ID%",variables:{PLAYER_ID:"PLAYER_ID"}},catching_success:{label:"Você pescou um %ITEM_LABEL%!",variables:{ITEM_LABEL:"ITEM_LABEL"}},unknown_error:{label:"Um erro ocorreu ao iniciar a pesca.",variables:{}},holdkeydown:{label:"SEGURE",variables:{}},press_to_cast:{label:"PARA LANÇAR",variables:{}},press_to_pull:{label:"PARA PUXAR",variables:{}}};var t=(langKey,vars)=>{const scriptLanguage=SETTINGS.DEFAULT_LANG;const locale=locales[scriptLanguage]||{};const overrides=localeOverrides(scriptLanguage);let phrase=overrides[langKey]||locale[langKey];if(!vars)return phrase;for(const varName of Object.keys(vars)){phrase=phrase.replace(`%${varName}%`,vars[varName])}return phrase};var localeOverrides=language=>(LOCALE_OVERRIDES==null?void 0:LOCALE_OVERRIDES[language])??{};var getLocaleVars=locale=>Object.values(locale).reduce((acc,curr,index)=>{if(typeof curr==="string"){acc[Object.keys(LocaleDefaults)[index]]=curr}else{acc[Object.keys(LocaleDefaults)[index]]=curr.label}return acc},{});var locales={"en-us":getLocaleVars(LocaleDefaults),"pt-br":getLocaleVars(BrazilianPortuguese)};var emitNetTyped=(eventName,playerid,...data)=>{emitNet(eventName,playerid,...data)};var onNetTyped=(eventName,func)=>{onNet(eventName,func)};var qbCoreGetPlayer=source=>{var _a,_b,_c,_d;const getPlayer=SETTINGS.INVENTORY_SYSTEM==="qbCore"&&((_d=(_c=(_b=(_a=exports["qb-core"])==null?void 0:_a.GetCoreObject)==null?void 0:_b.call(_a))==null?void 0:_c.Functions)==null?void 0:_d.GetPlayer);const player=getPlayer(source);if(!player){console.error("Player not found ",source);return false}return player};var oxInventoryAdapter={removeItem:(source,itemName)=>{exports["ox_inventory"].RemoveItem(source,itemName,1);return true},addItem:(source,itemName)=>{exports["ox_inventory"].AddItem(source,itemName,1);return true},getItem:itemName=>{const item=exports["ox_inventory"].Items(itemName);if(!item)return null;const{name,weight,label,stack,consume,client=null}=item;return{weight,unique:false,name,type:"item",description:name,label,combinable:stack,useable:consume,shouldClose:false,image:client==null?void 0:client.image}},notify:(source,message,type)=>TriggerClientEvent("ox_lib:notify",source,{title:"Fishing",description:message,type})};var qbCoreAdapter={removeItem:(source,itemName)=>{const player=qbCoreGetPlayer(source);if(!player){return false}player.Functions.RemoveItem(itemName,1);return true},addItem:(source,itemName)=>{const player=qbCoreGetPlayer(source);if(!player){return false}player.Functions.AddItem(itemName,1);return true},getItem:itemName=>{var _a,_b,_c,_d,_e;const item=(_e=(_d=(_c=(_b=(_a=exports["qb-core"])==null?void 0:_a.GetCoreObject)==null?void 0:_b.call(_a))==null?void 0:_c.Shared)==null?void 0:_d.Items)==null?void 0:_e[itemName];return item},notify:(source,message,type)=>{const player=qbCoreGetPlayer(source);if(!player){return false}TriggerClientEvent("QBCore:Notify",player.PlayerData.source,message,type);return true}};var esxGetPlayer=source=>{var _a,_b,_c;const ESX=(_b=(_a=exports["es_extended"])==null?void 0:_a.getSharedObject)==null?void 0:_b.call(_a);const player=(_c=ESX==null?void 0:ESX.GetPlayerFromId)==null?void 0:_c.call(ESX,source);if(!player){console.error("ESX Player not found ",source);return false}return player};var esxAdapter={removeItem:(source,itemName)=>{const player=esxGetPlayer(source);if(!player){return false}player.removeInventoryItem(itemName,1);return true},addItem:(source,itemName)=>{const player=esxGetPlayer(source);if(!player){return false}player.addInventoryItem(itemName,1);return true},getItem:itemName=>{var _a,_b,_c;const ESX=(_b=(_a=exports["es_extended"])==null?void 0:_a.getSharedObject)==null?void 0:_b.call(_a);const item=(_c=ESX==null?void 0:ESX.Items)==null?void 0:_c[itemName];if(!item)return null;return{name:item.name,label:item.label,weight:item.weight,type:"item",description:item.name,unique:false,useable:item.usable||false,rare:item.rare||false,canRemove:item.canRemove!==false,shouldClose:false,combinable:false,image:""}},notify:(source,message,type)=>{const player=esxGetPlayer(source);if(!player){return false}player.showNotification(message,type,5e3);return true}};var getAdapter=(adapters,adapter)=>{if(!adapters[adapter])throw new Error(`FATAL: ${adapter} is not supported, please check the documentation for supported inventory systems`);return adapters[adapter]};var enabledAdapter=SETTINGS.INVENTORY_SYSTEM||"ox_inventory";var getServerAdapter=()=>getAdapter({qbCore:qbCoreAdapter,ox_inventory:oxInventoryAdapter,esx_inventory:esxAdapter},enabledAdapter);var addItem=(source,itemName)=>getServerAdapter().addItem(source,itemName);var removeItem=(source,itemName)=>getServerAdapter().removeItem(source,itemName);var getItem=itemName=>getServerAdapter().getItem(itemName);var qbCoreGetPlayer2=()=>{var _a,_b,_c,_d;return SETTINGS.INVENTORY_SYSTEM==="qbCore"&&((_d=(_c=(_b=(_a=exports["qb-core"])==null?void 0:_a.GetCoreObject)==null?void 0:_b.call(_a))==null?void 0:_c.Functions)==null?void 0:_d.GetPlayer)};var oxLibAdapter={notify:(source,message,type)=>TriggerClientEvent("ox_lib:notify",source,{title:"Fishing",description:message,type})};var qbCoreAdapter2={notify:(source,message,type)=>{const player=qbCoreGetPlayer2()(source);if(!player){console.error("Player not found");return false}TriggerClientEvent("QBCore:Notify",player.PlayerData.source,message,type);return true}};var esxGetPlayer2=source=>{var _a,_b,_c;const ESX=(_b=(_a=exports["es_extended"])==null?void 0:_a.getSharedObject)==null?void 0:_b.call(_a);const player=(_c=ESX==null?void 0:ESX.GetPlayerFromId)==null?void 0:_c.call(ESX,source);if(!player){console.error("ESX Player not found ",source);return false}return player};var esxAdapter2={notify:(source,message,type)=>{const player=esxGetPlayer2(source);if(!player){return false}player.showNotification(message,type,5e3);return true}};var enabledAdapter2=SETTINGS.NOTIFICATION_SYSTEM||"oxLib";var getServerAdapter2=()=>getAdapter({qbCore:qbCoreAdapter2,oxLib:oxLibAdapter,esx:esxAdapter2},enabledAdapter2);var notify=(source,message,type)=>getServerAdapter2().notify(source,message,type);var playerAssignedFishes={};var getPlayerAssignedFish=playerId=>playerAssignedFishes[playerId];var processCatchFishEvent=playerId=>{const assignedFishId=playerAssignedFishes[playerId];if(!assignedFishId){notify(playerId,t("no_fish_assigned",{PLAYER_ID:playerId.toString()}),"error");return}const fish=fishes[assignedFishId];const itemInfo=getItem(fish.itemName);if(!itemInfo){console.error(`ERROR: Item ${fish.itemName} does not exist. Please be sure you added all fishing items to your inventory system.`);return}addItem(playerId,fish.itemName);notify(playerId,t("catching_success",{ITEM_LABEL:itemInfo.label}),"success")};var processUseBaitEvent=playerId=>{if(!removeItem(playerId,"commonbait")){notify(playerId,t("has_bait_error"),"error")}};var processRequestStartFishing=playerId=>{const randomNumber=Math.round(Math.random()*(Object.values(fishes).length-1));const randomFish=Object.keys(fishes)[randomNumber];playerAssignedFishes[playerId]=randomFish;emitNetTyped("brz-fishing:startFishing",playerId,randomFish)};var onResourceStart=resName=>{if(resName===GetCurrentResourceName()){console.log(t("initialise_script"))}};on("onResourceStart",onResourceStart);onNetTyped("brz-fishing:requestStartFishing",processRequestStartFishing);onNetTyped("brz-fishing:useBait",processUseBaitEvent);onNetTyped("brz-fishing:catchFish",processCatchFishEvent);0&&(module.exports={getPlayerAssignedFish,onResourceStart,processCatchFishEvent,processRequestStartFishing,processUseBaitEvent});
